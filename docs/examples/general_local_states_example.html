

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Generalized Local States Example &mdash; rescomp 0.2.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulations Example" href="simulations_example.html" />
    <link rel="prev" title="Training and Prediction Example" href="training_and_prediction_example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> rescomp
          

          
          </a>

          
            
            
              <div class="version">
                0.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#optional-but-strongly-encouraged-prerequesites">Optional (but Strongly Encouraged) Prerequesites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-instructions">Installation Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#common-installation-problems">Common Installation Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#the-installation-seems-to-have-worked-without-error-but-the-package-is-not-found-when-i-try-to-import-it">The installation seems to have worked without error, but the package is not found when I try to import it.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#nothing-works-please-help-me">Nothing works, please help me!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#updating">Updating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#uninstalling">Uninstalling</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="minimal_example.html">Minimal Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="higher_dim_example.html">Higher Dimensional Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="training_and_prediction_example.html">Training and Prediction Example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Generalized Local States Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulations_example.html">Simulations Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Rescomp Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rescomp_esn.html">ESN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rescomp_esn.html#esnwrapper-class">ESNWrapper Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rescomp_esn.html#esngenloc-class">ESNGenLoc Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rescomp_esn.html#esn-class">ESN Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rescomp_measures.html">Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rescomp_utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rescomp_simulations.html">Simulations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">CHANGELOG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-2-1-current-master-and-development-branch">rescomp 0.2.1 - Current Master and Development Branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-2-0">rescomp 0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-1-4">rescomp 0.1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-1-3">rescomp 0.1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-1-2">rescomp 0.1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-1-1">rescomp 0.1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#rescomp-0-1-0">rescomp 0.1.0</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rescomp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Generalized Local States Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Generalized-Local-States-Example">
<h1>Generalized Local States Example<a class="headerlink" href="#Generalized-Local-States-Example" title="Permalink to this headline">¶</a></h1>
<p>This example depicts the basic use of generalized local states in the context of RC as implemented in rescomp.esn.ESNGenLoc()</p>
<div class="line-block">
<div class="line">A more detailed explanation of generalized local states is given here:</div>
<div class="line"><a class="reference external" href="https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.3.023215">Baur, S.; Räth, C. Predicting High-Dimensional Heterogeneous Time Series Employing Generalized Local States. Phys. Rev. Res. 2021, 3, 23215.</a></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">rescomp</span>
<span class="kn">from</span> <span class="nn">rescomp.simulations</span> <span class="kn">import</span> <span class="n">simulate_trajectory</span>
</pre></div>
</div>
</div>
<p>Simulation Parameters</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ks_dim</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># 40 or 64</span>
<span class="n">ks_size</span> <span class="o">=</span> <span class="mi">22</span>  <span class="c1"># 22</span>
<span class="n">ks_dt</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0.05</span>

<span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">disc_ts</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">sync_ts</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">train_ts</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">pred_ts</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">tot_ts</span> <span class="o">=</span> <span class="n">disc_ts</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sync_ts</span> <span class="o">+</span> <span class="n">train_ts</span> <span class="o">+</span> <span class="n">pred_ts</span>
</pre></div>
</div>
</div>
<p>Simulation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ks_signal</span> <span class="o">=</span> <span class="n">simulate_trajectory</span><span class="p">(</span>
    <span class="n">sys_flag</span><span class="o">=</span><span class="s2">&quot;kuramoto_sivashinsky&quot;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">ks_dim</span><span class="p">,</span>
    <span class="n">system_size</span><span class="o">=</span><span class="n">ks_size</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">ks_dt</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">tot_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Plot the simulation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ks_title</span> <span class="o">=</span> <span class="s2">&quot;KS, N=</span><span class="si">%d</span><span class="s2">, L=</span><span class="si">%d</span><span class="s2">, dt=</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">ks_dim</span><span class="p">,</span> <span class="n">ks_size</span><span class="p">,</span> <span class="n">ks_dt</span><span class="p">)</span>

<span class="n">ks_axis_ranges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">pred_ts</span><span class="p">,</span> <span class="n">tot_ts</span><span class="p">]</span>

<span class="n">ks_xlabel</span> <span class="o">=</span> <span class="s2">&quot;Timestep&quot;</span>
<span class="n">ks_ylabel</span> <span class="o">=</span> <span class="s2">&quot;Dimension&quot;</span>

<span class="n">signal_raw</span> <span class="o">=</span> <span class="n">ks_signal</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">ks_signal</span><span class="p">[</span><span class="n">ks_axis_ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">ks_axis_ranges</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ks_title</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">ks_xlabel</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ks_ylabel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Dimension&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_general_local_states_example_7_1.png" src="../_images/examples_general_local_states_example_7_1.png" />
</div>
</div>
<p>Add normal noise to the training data. This is not necessary for the generalized local state code to work, but it’s more realistic and increases long term prediction accuracy. Note that we don’t add noise to the data used to test the prediction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">noise_scale</span> <span class="o">=</span> <span class="mf">1e-2</span>

<span class="n">ts_until_train_end</span> <span class="o">=</span> <span class="n">disc_ts</span> <span class="o">+</span> <span class="n">sync_ts</span> <span class="o">+</span> <span class="n">train_ts</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">noise_scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">ts_until_train_end</span><span class="p">,</span> <span class="n">signal_raw</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">signal_raw</span><span class="p">)</span>
<span class="n">signal</span><span class="p">[:</span><span class="n">noise</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[:</span><span class="n">noise</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">noise</span>
</pre></div>
</div>
</div>
<p>Calculate the different locality matrices, then put them into neighborhoods.</p>
<ul class="simple">
<li><p>SN: Spatial neighborhood. Just put the spatially closest dimensions together. Spatial in this case refers to the dimension’s index, so dimension 2 is closer to dimension 3 than it is to dimension 15.</p></li>
<li><p>CC: Cross Correlation Neighborhood. Locality is calculated via the cross correlation between dimensions.</p></li>
<li><p>NMI: (Normalized) Mutual Information Neihborhood. Locality is calculated via via the normalized mutual information between dimensions.</p></li>
</ul>
<div class="line-block">
<div class="line">We also set the number of neighbors to 18, simply because it works well for this iteration of the KS system used as data here.</div>
<div class="line">A larger number of neighbors results in a possibly better prediction at the cost of requiring larger reservoirs and longer training times. Making the neighborhood too small though, will cut out important dimensions, possibly reducing prediction accuracy or making training completely impossible.</div>
<div class="line">If you don’t know your neighborhood size a priori just treat the neighborhood size as another hyperparameter to optimize somewhere in the range of 10 to 50 and you will probably be fine.</div>
</div>
<p>For more detail on how the above is implemented exactly, please read <a class="reference external" href="https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.3.023215">Baur, Räth 2021, PRR</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sn_loc_matrix</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">locality_measures</span><span class="o">.</span><span class="n">sn_loc</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">cc_loc_matrix</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">locality_measures</span><span class="o">.</span><span class="n">cc_loc</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">nmi_loc_matrix</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">locality_measures</span><span class="o">.</span><span class="n">nmi_loc</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="n">nbs</span> <span class="o">=</span> <span class="mi">18</span> <span class="c1"># Nr. of neighbors in each neighborhood</span>

<span class="n">sn_nbhds</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">locality_measures</span><span class="o">.</span><span class="n">find_local_neighborhoods</span><span class="p">(</span>
                <span class="n">sn_loc_matrix</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">nbs</span><span class="p">)</span>
<span class="n">cc_nbhds</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">locality_measures</span><span class="o">.</span><span class="n">find_local_neighborhoods</span><span class="p">(</span>
                <span class="n">cc_loc_matrix</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">nbs</span><span class="p">)</span>
<span class="n">nmi_nbhds</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">locality_measures</span><span class="o">.</span><span class="n">find_local_neighborhoods</span><span class="p">(</span>
                <span class="n">nmi_loc_matrix</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">nbs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Define a plotting helper function to make the labels in the plots below look nicer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>

<span class="k">def</span> <span class="nf">force_colorbar_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">label_values</span><span class="p">):</span>
    <span class="n">label_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="o">.</span><span class="n">cmap</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">label_values</span><span class="p">]</span>

    <span class="n">patches</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">label_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">label_values</span><span class="p">))]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
              <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Plot the three neighborhoods we calculated above.</p>
<p>For ‘simple’ systems defined by a purely local interaction which is known a priori, as is the case for the KS system we simulated above, the SN neighborhood is essentially the ‘correct’ neighborhood. That the CC and MI neighborhoods are able to reproduce the SN neighborhood to such a degree is a strong indication that they actually “understood” the relation between the dimensions in this case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SN Neighborhoods&quot;</span><span class="p">,</span> <span class="s2">&quot;CC Neighborhoods&quot;</span><span class="p">,</span> <span class="s2">&quot;MI Neighborhoods&quot;</span><span class="p">]</span>
<span class="n">nbhds</span> <span class="o">=</span> <span class="p">[</span><span class="n">sn_nbhds</span><span class="p">,</span> <span class="n">cc_nbhds</span><span class="p">,</span> <span class="n">nmi_nbhds</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">nbhds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dimension&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Neighborhood&quot;</span><span class="p">)</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Core&#39;</span><span class="p">,</span> <span class="s1">&#39;Neighbor&#39;</span><span class="p">,</span> <span class="s1">&#39;Else&#39;</span><span class="p">]</span>
    <span class="n">label_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">force_colorbar_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">label_values</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_general_local_states_example_15_0.png" src="../_images/examples_general_local_states_example_15_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_general_local_states_example_15_1.png" src="../_images/examples_general_local_states_example_15_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_general_local_states_example_15_2.png" src="../_images/examples_general_local_states_example_15_2.png" />
</div>
</div>
<p>Here we choose the neighborhood to use for the ESN training and prediction below.</p>
<p>Which one to choose, or if you should just calculate/define your own neighborhood separate from the three we defined above, depends on the problem you are trying to solve.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># loc_nbhds = sn_nbhds</span>
<span class="c1"># loc_nbhds = cc_nbhds</span>
<span class="n">loc_nbhds</span> <span class="o">=</span> <span class="n">nmi_nbhds</span>
</pre></div>
</div>
</div>
<p>Create the ESN setup, in this case given by the ESNGenLoc() class. Then train and predict with it, as we have done in the other examples.</p>
<p>As training and prediction will take quite a while, we also set the console logger to “debug”, which will print out the calculation process to the terminal.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_dim</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">w_out_fit_flag</span> <span class="o">=</span> <span class="s2">&quot;linear_and_square_r&quot;</span>
<span class="n">avg_degree</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">regularization</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="n">spectral_radius</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">w_in_scale</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">w_in_sparse</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">train_core_only</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">loc_esn</span> <span class="o">=</span> <span class="n">rescomp</span><span class="o">.</span><span class="n">esn</span><span class="o">.</span><span class="n">ESNGenLoc</span><span class="p">()</span>
<span class="n">loc_esn</span><span class="o">.</span><span class="n">set_console_logger</span><span class="p">(</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span>

<span class="n">loc_esn</span><span class="o">.</span><span class="n">create_network</span><span class="p">(</span><span class="n">n_dim</span><span class="o">=</span><span class="n">n_dim</span><span class="p">,</span><span class="n">n_rad</span><span class="o">=</span><span class="n">spectral_radius</span><span class="p">,</span> <span class="n">n_avg_deg</span><span class="o">=</span><span class="n">avg_degree</span><span class="p">)</span>

<span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">loc_esn</span><span class="o">.</span><span class="n">train_and_predict</span><span class="p">(</span>
    <span class="n">x_data</span><span class="o">=</span><span class="n">signal</span><span class="p">,</span>
    <span class="n">disc_steps</span><span class="o">=</span><span class="n">disc_ts</span><span class="p">,</span>
    <span class="n">train_sync_steps</span><span class="o">=</span><span class="n">sync_ts</span><span class="p">,</span>
    <span class="n">train_steps</span><span class="o">=</span><span class="n">train_ts</span><span class="p">,</span>
    <span class="n">pred_sync_steps</span><span class="o">=</span><span class="n">sync_ts</span><span class="p">,</span>
    <span class="n">loc_nbhds</span><span class="o">=</span><span class="n">loc_nbhds</span><span class="p">,</span>
    <span class="n">reg_param</span><span class="o">=</span><span class="n">regularization</span><span class="p">,</span>
    <span class="n">w_in_scale</span><span class="o">=</span><span class="n">w_in_scale</span><span class="p">,</span>
    <span class="n">w_in_sparse</span><span class="o">=</span><span class="n">w_in_sparse</span><span class="p">,</span>
    <span class="n">train_core_only</span><span class="o">=</span><span class="n">train_core_only</span><span class="p">,</span>
    <span class="n">w_out_fit_flag</span><span class="o">=</span><span class="n">w_out_fit_flag</span>
    <span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
08-17 08:31:09 [DEBUG  ] Start locality training with 40 neighborhoods
08-17 08:31:09 [DEBUG  ] Deepcopy initial ESN instance for each Neighborhood. Reservoir network matrix are shallow copies though.
08-17 08:31:09 [DEBUG  ] Start Training of Neighborhood 1/40
08-17 08:35:26 [DEBUG  ] Start Training of Neighborhood 2/40
08-17 08:38:30 [DEBUG  ] Start Training of Neighborhood 3/40
08-17 08:41:09 [DEBUG  ] Start Training of Neighborhood 4/40
08-17 08:43:37 [DEBUG  ] Start Training of Neighborhood 5/40
08-17 08:46:00 [DEBUG  ] Start Training of Neighborhood 6/40
08-17 08:48:33 [DEBUG  ] Start Training of Neighborhood 7/40
08-17 08:51:02 [DEBUG  ] Start Training of Neighborhood 8/40
08-17 08:53:45 [DEBUG  ] Start Training of Neighborhood 9/40
08-17 08:56:26 [DEBUG  ] Start Training of Neighborhood 10/40
08-17 08:59:28 [DEBUG  ] Start Training of Neighborhood 11/40
08-17 09:02:17 [DEBUG  ] Start Training of Neighborhood 12/40
08-17 09:04:40 [DEBUG  ] Start Training of Neighborhood 13/40
08-17 09:07:33 [DEBUG  ] Start Training of Neighborhood 14/40
08-17 09:10:37 [DEBUG  ] Start Training of Neighborhood 15/40
08-17 09:14:13 [DEBUG  ] Start Training of Neighborhood 16/40
08-17 09:16:51 [DEBUG  ] Start Training of Neighborhood 17/40
08-17 09:19:58 [DEBUG  ] Start Training of Neighborhood 18/40
08-17 09:22:55 [DEBUG  ] Start Training of Neighborhood 19/40
08-17 09:27:04 [DEBUG  ] Start Training of Neighborhood 20/40
08-17 09:30:06 [DEBUG  ] Start Training of Neighborhood 21/40
08-17 09:33:18 [DEBUG  ] Start Training of Neighborhood 22/40
08-17 09:36:11 [DEBUG  ] Start Training of Neighborhood 23/40
08-17 09:39:51 [DEBUG  ] Start Training of Neighborhood 24/40
08-17 09:43:14 [DEBUG  ] Start Training of Neighborhood 25/40
08-17 09:47:03 [DEBUG  ] Start Training of Neighborhood 26/40
08-17 09:50:27 [DEBUG  ] Start Training of Neighborhood 27/40
08-17 09:53:59 [DEBUG  ] Start Training of Neighborhood 28/40
08-17 09:57:47 [DEBUG  ] Start Training of Neighborhood 29/40
08-17 10:01:41 [DEBUG  ] Start Training of Neighborhood 30/40
08-17 10:05:43 [DEBUG  ] Start Training of Neighborhood 31/40
08-17 10:09:25 [DEBUG  ] Start Training of Neighborhood 32/40
08-17 10:13:05 [DEBUG  ] Start Training of Neighborhood 33/40
08-17 10:16:15 [DEBUG  ] Start Training of Neighborhood 34/40
08-17 10:19:45 [DEBUG  ] Start Training of Neighborhood 35/40
08-17 10:23:14 [DEBUG  ] Start Training of Neighborhood 36/40
08-17 10:26:48 [DEBUG  ] Start Training of Neighborhood 37/40
08-17 10:29:35 [DEBUG  ] Start Training of Neighborhood 38/40
08-17 10:32:32 [DEBUG  ] Start Training of Neighborhood 39/40
08-17 10:36:12 [DEBUG  ] Start Training of Neighborhood 40/40
08-17 10:39:45 [DEBUG  ] Start local prediction
08-17 10:39:45 [DEBUG  ] Start syncing
08-17 10:40:00 [DEBUG  ] Prediction for 0/500 steps done
08-17 10:40:06 [DEBUG  ] Prediction for 500/500 steps done
</pre></div></div>
</div>
<p>Plot the prediction results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                            <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Simulation&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Prediction&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">y_test</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference between simulation and prediction&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;dimension&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time steps&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_general_local_states_example_21_0.png" src="../_images/examples_general_local_states_example_21_0.png" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="simulations_example.html" class="btn btn-neutral float-right" title="Simulations Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="training_and_prediction_example.html" class="btn btn-neutral float-left" title="Training and Prediction Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Jonas Aumeier, Sebastian Baur, Joschka Herteux, Youssef Mabrouk.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>